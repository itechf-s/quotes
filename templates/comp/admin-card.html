{% load static %}

  <script>
   function activate(id, isActive) {
    let formData = new FormData();
      formData.append('id', id);
      formData.append('isActive', isActive);
      formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');
      fetch("/wp-admin/activate",{
        body: formData,
        method: "post"
    });
    delDiv('qCardDiv' + id);
   }
//schedule quotes
   function schedule(id, isSchd) {
    let formData = new FormData();
      formData.append('id', id);
      formData.append('isSchd', isSchd);
      formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');
      fetch("/wp-admin/activate",{
        body: formData,
        method: "post"
    });
    delDiv('qCardDiv' + id);
   }

    function makeQuote(id) {
    let formData = new FormData();
      formData.append('id', id);
      formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');
      fetch("/wp-admin/make-quote",{
        body: formData,
        method: "post"
    });
    delDiv('qCardDiv' + id);
    
   }

    function prepareQuotes(id) {
    let formData = new FormData();
      formData.append('id', id);
      formData.append('csrfmiddlewaretoken', '{{ csrf_token }}');
      fetch("/wp-admin/update",{
        body: formData,
        method: "post"
    });
    //console.log(id)
    window.location.reload()
    
  }

  function delDiv(id) {
    var myDiv = document.getElementById(id);
    myDiv.remove();
  }

  function changeImg(id, imgId) {
    var myImg = document.getElementById("raw-img-" + id);
    var newImgId = document.getElementById(imgId).value;
    myImg.src = "{% static 'images/raw/' %}" + newImgId + ".jpg"
  }
   </script>
<div class="card-group mt-3 mb-3 ms-1 me-1">
{% for quote in quotes %}
  <div class="card mb-1 ms-1 me-1" id="qCardDiv{{quote.id}}">
  <div class="row">
    <div class="col">
      <img src="{% static 'images/' %}{{quote.imagePath}}?v={% now 'u' %}" class="img-fluid rounded" alt="{{quote.imageAlt}}">
    </div>
    {% if quote.isPin == 1 %}
    <div class="col">
        <img src="{% static 'images/' %}{{quote.imagePathPin}}?v={% now 'u' %}" class="img-fluid rounded" alt="{{quote.imageAlt}}">
    </div>
    {% endif %}
  </div>
    <div class="card-body">
      <p class="card-text text-center blockquote">{{quote.id}}. {{quote.quotes}}</p>
      <p class="text-end">{{quote.author}}</p>
      <p class="card-text">{{quote.category}}</p>
      <p class="card">{{quote.publishAt}}</p>
      {% if quote.isActive == 0 and quote.isUpdated == 0 %}
      <p class="btn btn-outline-dark btn-sm" onclick="prepareQuotes({{quote.id}}, 1)">Prepare Quotes</p>
      {% endif %}
      {% if quote.isActive == 0 and quote.isUpdated == 1 %}
        {% if quote.isSchd == 0 %}
        <p class="btn btn-outline-dark btn-sm" onclick="schedule({{quote.id}}, 1)">Schedule</p>
        {% endif %}
      <p class="btn btn-outline-dark btn-sm" onclick="activate({{quote.id}}, 1)">Publish</p>
      {% endif %}
      {% if quote.isActive == 1 %}
      <p class="btn btn-outline-dark btn-sm" onclick="activate({{quote.id}}, 0)">Draft</p>
      {% endif %}
      {% if quote.isSchd == 1 %}
      <p class="btn btn-outline-dark btn-sm" onclick="schedule({{quote.id}}, 0)">Unschedule</p>
      {% endif %}
      {% if quote.isUpdated == 1 %}
      {% include './makeQuoteModal.html' %}
      {% endif %}
      
    </div>
  </div>
    {% if forloop.counter|divisibleby:"3" %}
      </div>
      <div class="card-group mt-3 mb-3 ms-1 me-1">
    {% endif %}
  {% endfor %}
</div>
{% include './searchModal.html' %}
{% include './importImageModal.html' %}